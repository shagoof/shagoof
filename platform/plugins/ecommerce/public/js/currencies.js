(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,a(n.key),n)}}function a(t){var a=function(t,a){if("object"!=e(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,a||"default");if("object"!=e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(t)}(t,"string");return"symbol"==e(a)?a:a+""}var r=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.template=$("#currency_template").html(),this.totalItem=0,this.deletedItems=[],this.initData(),this.handleForm(),this.updateCurrency(),this.clearCacheRates(),this.changeOptionUsingExchangeRateCurrencyFormAPI(),this.handleAdvancedToggle()},(a=[{key:"initData",value:function(){var e=this,t=$.parseJSON($("#currencies").html());$.each(t,function(t,a){var r=e.template.replace(/__id__/gi,a.id).replace(/__position__/gi,a.order).replace(/__isPrefixSymbolChecked__/gi,1==a.is_prefix_symbol?"selected":"").replace(/__notIsPrefixSymbolChecked__/gi,0==a.is_prefix_symbol?"selected":"").replace(/__isDefaultChecked__/gi,1==a.is_default?"checked":"").replace(/__westernFormatChecked__/gi,"western"==(a.number_format_style||"western")?"selected":"").replace(/__indianFormatChecked__/gi,"indian"==a.number_format_style?"selected":"").replace(/__spaceBetweenPriceAndCurrencyChecked__/gi,1==a.space_between_price_and_currency?"checked":"").replace(/__title__/gi,a.title).replace(/__decimals__/gi,a.decimals).replace(/__exchangeRate__/gi,a.exchange_rate).replace(/__symbol__/gi,a.symbol);$(".swatches-container .swatches-list").append(r),e.totalItem++})}},{key:"addNewAttribute",value:function(){var e=this,t=e.template.replace(/__id__/gi,0).replace(/__position__/gi,e.totalItem).replace(/__isPrefixSymbolChecked__/gi,"").replace(/__notIsPrefixSymbolChecked__/gi,"").replace(/__isDefaultChecked__/gi,0==e.totalItem?"checked":"").replace(/__westernFormatChecked__/gi,"selected").replace(/__indianFormatChecked__/gi,"").replace(/__spaceBetweenPriceAndCurrencyChecked__/gi,"").replace(/__title__/gi,"").replace(/__decimals__/gi,0).replace(/__exchangeRate__/gi,1).replace(/__symbol__/gi,"");$(".swatches-container .swatches-list").append(t),e.totalItem++}},{key:"exportData",value:function(){var e=[];return $(".swatches-container .swatches-list li.currency-item").each(function(t,a){var r=$(a);e.push({id:r.data("id"),is_default:r.find(".currency-row [data-type=is_default] input[type=radio]").is(":checked")?1:0,order:r.index(),title:r.find(".currency-row [data-type=title] input").val(),symbol:r.find(".currency-row [data-type=symbol] input").val(),decimals:r.find(".currency-advanced-settings [data-type=decimals]").val(),number_format_style:r.find(".currency-advanced-settings [data-type=number_format_style]").val(),space_between_price_and_currency:r.find(".currency-advanced-settings [data-type=space_between_price_and_currency]").is(":checked")?1:0,exchange_rate:r.find(".currency-row [data-type=exchange_rate] input").val(),is_prefix_symbol:r.find(".currency-advanced-settings [data-type=is_prefix_symbol]").val()})}),e}},{key:"handleForm",value:function(){var e=this;$(".swatches-container .swatches-list").sortable(),$("body").on("submit",".currency-setting-form",function(){var t=e.exportData();$("#currencies").val(JSON.stringify(t)),$("#deleted_currencies").val(JSON.stringify(e.deletedItems))}).on("click",".js-add-new-attribute",function(t){t.preventDefault(),e.addNewAttribute()}).on("click",".swatches-container .swatches-list li .remove-item a",function(t){t.preventDefault();var a=$(t.currentTarget).closest("li");e.deletedItems.push(a.data("id")),a.remove()})}},{key:"updateCurrency",value:function(){$(document).on("click","#btn-update-currencies",function(e){e.preventDefault();var t=$(e.currentTarget),a=$(".currency-setting-form");$httpClient.make().post(a.prop("action"),a.serialize()).then(function(e){var r=e.data;r.error?Botble.showError(r.message):$httpClient.make().withButtonLoading(t).withLoading(a.find(".swatches-container")).post(t.data("url")).then(function(e){var t=e.data;if(t.error)Botble.showNotice("error",t.message);else{Botble.showNotice("success",t.message);var a=$("#currency_template").html(),r="";$.each(t.data,function(e,t){r+=a.replace(/__id__/gi,t.id).replace(/__position__/gi,t.order).replace(/__isPrefixSymbolChecked__/gi,1==t.is_prefix_symbol?"selected":"").replace(/__notIsPrefixSymbolChecked__/gi,0==t.is_prefix_symbol?"selected":"").replace(/__isDefaultChecked__/gi,1==t.is_default?"checked":"").replace(/__westernFormatChecked__/gi,"western"==(t.number_format_style||"western")?"selected":"").replace(/__indianFormatChecked__/gi,"indian"==t.number_format_style?"selected":"").replace(/__spaceBetweenPriceAndCurrencyChecked__/gi,1==t.space_between_price_and_currency?"checked":"").replace(/__title__/gi,t.title).replace(/__decimals__/gi,t.decimals).replace(/__exchangeRate__/gi,t.exchange_rate).replace(/__symbol__/gi,t.symbol)}),setTimeout(function(){$(".swatches-container .swatches-list").html(r)},1e3)}})})})}},{key:"clearCacheRates",value:function(){$(document).on("click","#btn-clear-cache-rates",function(e){e.preventDefault();var t=$(e.currentTarget);$httpClient.make().withButtonLoading(t).post(t.data("url")).then(function(e){var t=e.data;t.error?Botble.showError(t.message):Botble.showSuccess(t.message)})})}},{key:"changeOptionUsingExchangeRateCurrencyFormAPI",value:function(){$(document).on("change",'input[name="use_exchange_rate_from_api"]',function(e){e.preventDefault();var t=$(".swatch-exchange-rate").find(".input-exchange-rate");e.target.checked?t.prop("disabled",!0):t.prop("disabled",!1)})}},{key:"handleAdvancedToggle",value:function(){$(document).on("click",".toggle-advanced",function(e){e.preventDefault();var t=$(e.currentTarget),a=t.closest(".currency-item").find(".currency-advanced-settings");a.slideToggle(300,function(){a.is(":visible")?t.addClass("active"):t.removeClass("active")})})}}])&&t(e.prototype,a),r&&t(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,a,r}();$(function(){return new r})})();